{% extends "_layout" %}

{% set entry = craft.entries.section('resourcesPublications').one() %}
{% set title = entry.title %}

{% block content %}
<div class="page-title --resources" style="background-image: url('{{ entry.headerBackgroundImage.one().url }}'); background-size: cover; background-position: 50% 50%;">
    <div class="container">
        <div class="col-md-8 col-centered">
            <h2 class="subheadline">{{ entry.headerHeadline }}</h2>
            <h1 class="headline">{{ entry.headerSubheadline|striptags|raw }}</h1>
        </div>
    </div>
</div>

<div id="publications">
	<div class="container">
		<div class="row instructions">
			<div class="col-md-6 col-centered">
				<p>Click on a paper's title to view the abstract and/or download a PDF of the full paper.</p>
			</div>
		</div>
		<div class="row matrix">
			{% for block in entry.papers.all() %}
				<div class="col-md-6">
					{% set key = [block.paperPub, block.paperPubDate]|join('-')|replace(' ', '') %}
					<a href="#abstractModal-{{key}}" class="fl publication">
						<svg width="20px" height="24px" viewBox="0 0 20 24" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
						    <defs></defs>
						    <g id="Full-Design" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
						        <g id="Resources---Publications" transform="translate(-782.000000, -600.000000)" stroke="#D80000" stroke-width="0.1" fill="#D80000" fill-rule="nonzero">
						            <g id="Group-4" transform="translate(783.000000, 601.000000)">
						                <path d="M12.3924978,0.733335686 L11.8749979,0.163780193 C11.7797566,0.059192777 11.6432184,-0.00043899837 11.499998,2.43355884e-06 L1.99999965,2.43355884e-06 C0.895430343,2.43355884e-06 0,0.875534381 0,1.95555777 L0,20.0444447 C0,21.1244681 0.895430343,22 1.99999965,22 L15.9999972,22 C17.1045665,22 17.9999968,21.1244681 17.9999968,20.0444447 L17.9999968,7.08889054 C18.000432,6.96921337 17.9559563,6.85353715 17.8749969,6.76377946 L12.4999978,0.85311345 L12.4999978,0.733335686 L12.3924978,0.733335686 Z M16.999997,20.0444447 C16.999997,20.5844564 16.5522818,21.0222223 15.9999972,21.0222223 L1.99999965,21.0222223 C1.447715,21.0222223 0.999999824,20.5844564 0.999999824,20.0444447 L0.999999824,1.95555777 C0.999999824,1.41554608 1.447715,0.977780103 1.99999965,0.977780103 L11.274998,0.977780103 L11.499998,1.22222452 L11.499998,5.86666845 C11.499998,6.54168307 12.0596419,7.08889054 12.7499978,7.08889054 L16.829997,7.08889054 L16.999997,7.2746683 L16.999997,20.0444447 Z M15.9424972,6.11111287 L12.7499978,6.11111287 C12.6119266,6.11111287 12.4999978,6.00167138 12.4999978,5.86666845 L12.4999978,2.32466884 L15.9424972,6.11111287 Z" id="Shape"></path>
						                <path d="M13.8857143,10.56 L4.11428571,10.56 C3.83025356,10.56 3.6,10.7569947 3.6,11 C3.6,11.2430053 3.83025356,11.44 4.11428571,11.44 L13.8857143,11.44 C14.1697464,11.44 14.4,11.2430053 14.4,11 C14.4,10.7569947 14.1697464,10.56 13.8857143,10.56 Z" id="Shape"></path>
						                <path d="M13.8857143,14.08 L4.11428571,14.08 C3.83025356,14.08 3.6,14.2769947 3.6,14.52 C3.6,14.7630053 3.83025356,14.96 4.11428571,14.96 L13.8857143,14.96 C14.1697464,14.96 14.4,14.7630053 14.4,14.52 C14.4,14.2769947 14.1697464,14.08 13.8857143,14.08 Z" id="Shape"></path>
						                <path d="M13.8857143,17.6 L4.11428571,17.6 C3.83025356,17.6 3.6,17.7969947 3.6,18.04 C3.6,18.2830053 3.83025356,18.48 4.11428571,18.48 L13.8857143,18.48 C14.1697464,18.48 14.4,18.2830053 14.4,18.04 C14.4,17.7969947 14.1697464,17.6 13.8857143,17.6 Z" id="Shape"></path>
						                <path d="M4.09090909,7.04 L8.50909091,7.04 C8.78021251,7.04 9,6.84300529 9,6.6 C9,6.35699471 8.78021251,6.16 8.50909091,6.16 L4.09090909,6.16 C3.81978749,6.16 3.6,6.35699471 3.6,6.6 C3.6,6.84300529 3.81978749,7.04 4.09090909,7.04 Z" id="Shape"></path>
						            </g>
						        </g>
						    </g>
						</svg>
						<h5 class="pub">{{ block.paperPub }} <span class="date">{{ block.paperPubDate}}</span></h5>
						<h3 class="title">{{ block.paperTitle|striptags('<em><strong>') }}</h3>
						{% set abstract = block.paperAbstract|striptags|replace('&amp;', '&') %}
						<p>{{ abstract | length > 235 ? abstract| slice(0, 235) ~ '...' : abstract }}</p>
					</a>
				</div>

				<div class="modal-wrapper">
					<div id="abstractModal-{{key}}" class="publication-modal fl-modal">
						<svg width="20px" height="24px" viewBox="0 0 20 24" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
						    <defs></defs>
						    <g id="Full-Design" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
						        <g id="Resources---Publications" transform="translate(-782.000000, -600.000000)" stroke="#D80000" stroke-width="0.1" fill="#D80000" fill-rule="nonzero">
						            <g id="Group-4" transform="translate(783.000000, 601.000000)">
						                <path d="M12.3924978,0.733335686 L11.8749979,0.163780193 C11.7797566,0.059192777 11.6432184,-0.00043899837 11.499998,2.43355884e-06 L1.99999965,2.43355884e-06 C0.895430343,2.43355884e-06 0,0.875534381 0,1.95555777 L0,20.0444447 C0,21.1244681 0.895430343,22 1.99999965,22 L15.9999972,22 C17.1045665,22 17.9999968,21.1244681 17.9999968,20.0444447 L17.9999968,7.08889054 C18.000432,6.96921337 17.9559563,6.85353715 17.8749969,6.76377946 L12.4999978,0.85311345 L12.4999978,0.733335686 L12.3924978,0.733335686 Z M16.999997,20.0444447 C16.999997,20.5844564 16.5522818,21.0222223 15.9999972,21.0222223 L1.99999965,21.0222223 C1.447715,21.0222223 0.999999824,20.5844564 0.999999824,20.0444447 L0.999999824,1.95555777 C0.999999824,1.41554608 1.447715,0.977780103 1.99999965,0.977780103 L11.274998,0.977780103 L11.499998,1.22222452 L11.499998,5.86666845 C11.499998,6.54168307 12.0596419,7.08889054 12.7499978,7.08889054 L16.829997,7.08889054 L16.999997,7.2746683 L16.999997,20.0444447 Z M15.9424972,6.11111287 L12.7499978,6.11111287 C12.6119266,6.11111287 12.4999978,6.00167138 12.4999978,5.86666845 L12.4999978,2.32466884 L15.9424972,6.11111287 Z" id="Shape"></path>
						                <path d="M13.8857143,10.56 L4.11428571,10.56 C3.83025356,10.56 3.6,10.7569947 3.6,11 C3.6,11.2430053 3.83025356,11.44 4.11428571,11.44 L13.8857143,11.44 C14.1697464,11.44 14.4,11.2430053 14.4,11 C14.4,10.7569947 14.1697464,10.56 13.8857143,10.56 Z" id="Shape"></path>
						                <path d="M13.8857143,14.08 L4.11428571,14.08 C3.83025356,14.08 3.6,14.2769947 3.6,14.52 C3.6,14.7630053 3.83025356,14.96 4.11428571,14.96 L13.8857143,14.96 C14.1697464,14.96 14.4,14.7630053 14.4,14.52 C14.4,14.2769947 14.1697464,14.08 13.8857143,14.08 Z" id="Shape"></path>
						                <path d="M13.8857143,17.6 L4.11428571,17.6 C3.83025356,17.6 3.6,17.7969947 3.6,18.04 C3.6,18.2830053 3.83025356,18.48 4.11428571,18.48 L13.8857143,18.48 C14.1697464,18.48 14.4,18.2830053 14.4,18.04 C14.4,17.7969947 14.1697464,17.6 13.8857143,17.6 Z" id="Shape"></path>
						                <path d="M4.09090909,7.04 L8.50909091,7.04 C8.78021251,7.04 9,6.84300529 9,6.6 C9,6.35699471 8.78021251,6.16 8.50909091,6.16 L4.09090909,6.16 C3.81978749,6.16 3.6,6.35699471 3.6,6.6 C3.6,6.84300529 3.81978749,7.04 4.09090909,7.04 Z" id="Shape"></path>
						            </g>
						        </g>
						    </g>
						</svg>
						<h5 class="pub">{{ block.paperPub }} <span class="date">{{ block.paperPubDate}}</span></h5>
						<h3 class="title">{{ block.paperTitle|striptags('<em><strong>') }}</h3>
						{% set abstract = block.paperAbstract|striptags %}
						<div class="abstract">
							{{ block.paperAbstract }}
						</div>

						<a href="{{ block.paperFile.one().url }}" target="_blank" rel="noopener" class="btn btn-secondary">Download Paper</a>
					</div>
				</div>
			{% endfor %}
		</div>
	</div>
</div>
{% endblock %}
